<UserControl x:Class="Uno_Platform.Components.CartItemCard"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:models="using:Uno_Platform.Models"
             xmlns:converters="using:Uno_Platform.Converters">
  
  <UserControl.Resources>
    <!-- Remove Animation -->
    <Storyboard x:Name="RemoveAnimation">
      <DoubleAnimation Storyboard.TargetName="ItemCard"
                      Storyboard.TargetProperty="Opacity"
                      To="0"
                      Duration="0:0:0.3">
        <DoubleAnimation.EasingFunction>
          <CubicEase EasingMode="EaseIn"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
      <DoubleAnimation Storyboard.TargetName="ItemCard"
                      Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                      To="-200"
                      Duration="0:0:0.3">
        <DoubleAnimation.EasingFunction>
          <CubicEase EasingMode="EaseIn"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
      <DoubleAnimation Storyboard.TargetName="ItemCard"
                      Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                      To="0.8"
                      Duration="0:0:0.3">
        <DoubleAnimation.EasingFunction>
          <CubicEase EasingMode="EaseIn"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
    </Storyboard>

    <!-- Quantity Change Animation -->
    <Storyboard x:Key="QuantityChangeAnimation">
      <DoubleAnimation Storyboard.TargetName="QuantityDisplay"
                      Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                      To="1.2"
                      Duration="0:0:0.15">
        <DoubleAnimation.EasingFunction>
          <BackEase EasingMode="EaseOut"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
      <DoubleAnimation Storyboard.TargetName="QuantityDisplay"
                      Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                      To="1.2"
                      Duration="0:0:0.15">
        <DoubleAnimation.EasingFunction>
          <BackEase EasingMode="EaseOut"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
      <DoubleAnimation Storyboard.TargetName="QuantityDisplay"
                      Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                      To="1.0"
                      BeginTime="0:0:0.15"
                      Duration="0:0:0.15">
        <DoubleAnimation.EasingFunction>
          <BackEase EasingMode="EaseIn"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
      <DoubleAnimation Storyboard.TargetName="QuantityDisplay"
                      Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                      To="1.0"
                      BeginTime="0:0:0.15"
                      Duration="0:0:0.15">
        <DoubleAnimation.EasingFunction>
          <BackEase EasingMode="EaseIn"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
    </Storyboard>

    <!-- Subtotal Update Animation -->
    <Storyboard x:Key="SubtotalUpdateAnimation">
      <DoubleAnimation Storyboard.TargetName="SubtotalBadge"
                      Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                      To="1.05"
                      Duration="0:0:0.2">
        <DoubleAnimation.EasingFunction>
          <BackEase EasingMode="EaseOut"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
      <DoubleAnimation Storyboard.TargetName="SubtotalBadge"
                      Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                      To="1.05"
                      Duration="0:0:0.2">
        <DoubleAnimation.EasingFunction>
          <BackEase EasingMode="EaseOut"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
      <DoubleAnimation Storyboard.TargetName="SubtotalBadge"
                      Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                      To="1.0"
                      BeginTime="0:0:0.2"
                      Duration="0:0:0.2">
        <DoubleAnimation.EasingFunction>
          <BackEase EasingMode="EaseIn"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
      <DoubleAnimation Storyboard.TargetName="SubtotalBadge"
                      Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                      To="1.0"
                      BeginTime="0:0:0.2"
                      Duration="0:0:0.2">
        <DoubleAnimation.EasingFunction>
          <BackEase EasingMode="EaseIn"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
    </Storyboard>
  </UserControl.Resources>

  <!-- Shadow Effect -->
  <Grid Margin="0,0,0,16">
    <!-- Shadow Border -->
    <Border Background="#20000000"
           CornerRadius="{StaticResource BorderRadiusLarge}"
           Margin="0,4,0,0"
           Opacity="0.4"/>
    
    <!-- Main Card with Acrylic Background -->
  <Border x:Name="ItemCard"
          Background="{StaticResource AcrylicBrush}"
            Padding="{StaticResource SpacingL}"
            CornerRadius="{StaticResource BorderRadiusLarge}"
            BorderThickness="2"
            BorderBrush="{StaticResource BorderBrush}"
          Opacity="1">
    <Border.RenderTransform>
      <CompositeTransform/>
    </Border.RenderTransform>
      
    <Grid ColumnDefinitions="Auto,*,Auto,Auto" 
            ColumnSpacing="{StaticResource SpacingL}">
        
      <!-- Product Image -->
      <Border Grid.Column="0"
                Width="120"
                Height="120"
                Background="{StaticResource PrimaryGradientBrush}"
                CornerRadius="{StaticResource BorderRadiusLarge}"
                Padding="4">
          <Border Background="{StaticResource SurfaceBrush}"
              CornerRadius="{StaticResource BorderRadiusMedium}">
        <Image Source="Assets/img/caby.png"
               Stretch="UniformToFill"
               HorizontalAlignment="Center"
               VerticalAlignment="Center"/>
          </Border>
      </Border>

        <!-- Product Info Section -->
      <StackPanel Grid.Column="1" 
                  VerticalAlignment="Center"
                   Spacing="{StaticResource SpacingS}">
          
          <!-- Product Name -->
        <TextBlock Text="{x:Bind CartItem.ProductName, Mode=OneWay}"
                   Style="{StaticResource Heading3Style}"
                    FontSize="20"
                    FontWeight="Bold"
                    TextWrapping="Wrap"
                    Foreground="{StaticResource TextPrimaryBrush}"
                    MaxLines="2"
                    TextTrimming="CharacterEllipsis"/>
          
          <!-- Category Badge -->
          <Border Background="{StaticResource PrimaryBrush}"
                 CornerRadius="12"
                 Padding="10,6"
                 HorizontalAlignment="Left"
                 Opacity="0.9">
        <TextBlock Text="{x:Bind CartItem.ProductCategory, Mode=OneWay}"
                      Foreground="White"
                      FontSize="12"
                      FontWeight="SemiBold"/>
          </Border>
          
          <!-- Unit Price -->
          <StackPanel Orientation="Horizontal" 
                     Spacing="6" 
                     Margin="0,8,0,0">
            <TextBlock Text="Price:"
                   Style="{StaticResource SecondaryTextStyle}"
                      FontSize="13"
                    VerticalAlignment="Center"/>
          <TextBlock Text="{x:Bind CartItem.ProductPrice, Mode=OneWay, Converter={StaticResource PriceFormatConverter}}"
                    Style="{StaticResource PriceTextStyle}"
                    FontSize="16"
                      FontWeight="SemiBold"
                      VerticalAlignment="Center"/>
            <TextBlock Text="each"
                    Style="{StaticResource SecondaryTextStyle}"
                    FontSize="12"
                    VerticalAlignment="Center"
                    Margin="4,0,0,0"/>
        </StackPanel>
          
      </StackPanel>

        <!-- Quantity Selector Section -->
      <Border Grid.Column="2"
               Background="{StaticResource SurfaceBrush}"
               CornerRadius="{StaticResource BorderRadiusLarge}"
               Padding="{StaticResource SpacingS}"
               VerticalAlignment="Center"
               BorderThickness="2"
               BorderBrush="{StaticResource BorderBrush}">
          <StackPanel Orientation="Horizontal"
                    Spacing="{StaticResource SpacingS}"
                    HorizontalAlignment="Center"
              VerticalAlignment="Center">
            
            <!-- Decrease Button -->
          <Button Content="âˆ’"
                   Width="44"
                   Height="44"
                  Style="{StaticResource IconButtonStyle}"
                  Background="{StaticResource PrimaryBrush}"
                  Foreground="White"
                   CornerRadius="{StaticResource BorderRadiusMedium}"
                   FontSize="24"
                  FontWeight="Bold"
                  Click="DecreaseQuantity_Click"/>
            
            <!-- Quantity Display -->
            <Border x:Name="QuantityDisplay"
                   Background="{StaticResource SurfaceBrush}"
                   Padding="16,8"
                   CornerRadius="{StaticResource BorderRadiusMedium}"
                   MinWidth="50"
                   BorderThickness="2"
                   BorderBrush="{StaticResource PrimaryBrush}"
                   VerticalAlignment="Center">
              <Border.RenderTransform>
                <ScaleTransform CenterX="0.5" CenterY="0.5"/>
              </Border.RenderTransform>
            <TextBlock Text="{x:Bind CartItem.Quantity, Mode=OneWay}"
                      Style="{StaticResource Heading3Style}"
                        FontSize="20"
                      FontWeight="Bold"
                      HorizontalAlignment="Center"
                        Foreground="{StaticResource PrimaryBrush}"/>
          </Border>
            
            <!-- Increase Button -->
          <Button Content="+"
                   Width="44"
                   Height="44"
                  Style="{StaticResource IconButtonStyle}"
                  Background="{StaticResource PrimaryBrush}"
                  Foreground="White"
                   CornerRadius="{StaticResource BorderRadiusMedium}"
                   FontSize="24"
                  FontWeight="Bold"
                  Click="IncreaseQuantity_Click"/>
        </StackPanel>
      </Border>

        <!-- Subtotal and Remove Section -->
      <StackPanel Grid.Column="3"
                  VerticalAlignment="Center"
                   Spacing="{StaticResource SpacingM}"
                   MinWidth="140">
          
          <!-- Subtotal Badge -->
          <Border x:Name="SubtotalBadge"
                 Background="{StaticResource PrimaryGradientBrush}"
                 Padding="16,12"
                 CornerRadius="{StaticResource BorderRadiusLarge}"
                 HorizontalAlignment="Right"
                 BorderThickness="2"
                 BorderBrush="{StaticResource BorderBrush}"
                 RenderTransformOrigin="0.5,0.5">
            <Border.RenderTransform>
              <ScaleTransform/>
            </Border.RenderTransform>
            <StackPanel Spacing="4">
              <TextBlock Text="Subtotal"
                        Foreground="White"
                        FontSize="11"
                        FontWeight="SemiBold"
                        Opacity="0.9"
                        HorizontalAlignment="Center"/>
          <TextBlock Text="{x:Bind CartItem.TotalPrice, Mode=OneWay, Converter={StaticResource PriceFormatConverter}}"
                    Foreground="White"
                        FontSize="22"
                    FontWeight="Bold"
                        HorizontalAlignment="Center"/>
            </StackPanel>
        </Border>
          
          <!-- Remove Button -->
        <Button Content="ðŸ—‘ï¸ Remove"
                Style="{StaticResource SecondaryButtonStyle}"
                 FontSize="{StaticResource FontSizeSmall}"
                 Padding="12,10"
                 CornerRadius="{StaticResource BorderRadiusMedium}"
                Background="#FFFEE2E2"
                BorderBrush="{StaticResource ErrorBrush}"
                 BorderThickness="2"
                Foreground="{StaticResource ErrorBrush}"
                FontWeight="SemiBold"
                Click="Remove_Click"
                 HorizontalAlignment="Right"/>
      </StackPanel>
        
    </Grid>
  </Border>
  </Grid>
</UserControl>
