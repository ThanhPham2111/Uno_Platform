<Page x:Class="Uno_Platform.Views.ProductDetailPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:Uno_Platform.Views"
      xmlns:controls="using:Uno_Platform.Controls"
      Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
  <Grid>
    <ScrollViewer Padding="20">
      <StackPanel Spacing="20" MaxWidth="600">
        
        <!-- Product Image/Icon -->
        <TextBlock Text="{x:Bind ViewModel.Image, Mode=OneWay}" 
                   FontSize="120"
                   HorizontalAlignment="Center"
                   Margin="0,20,0,20"/>
        
        <!-- Edit Mode Toggle -->
        <Button Content="{x:Bind ViewModel.IsEditMode, Converter={StaticResource EditModeConverter}}"
                Command="{x:Bind ViewModel.ToggleEditModeCommand}"
                HorizontalAlignment="Right"
                Margin="0,0,0,10"/>
        
        <!-- Product Name -->
        <TextBlock Text="Name" Style="{StaticResource LabelStyle}"/>
        <TextBox Text="{x:Bind ViewModel.Name, Mode=TwoWay}"
                 IsReadOnly="{x:Bind ViewModel.IsEditMode, Converter={StaticResource InverseBooleanConverter}}"
                 Style="{StaticResource StandardTextBoxStyle}"
                 Visibility="{x:Bind ViewModel.IsEditMode, Mode=OneWay}"/>
        <TextBlock Text="{x:Bind ViewModel.Name, Mode=OneWay}"
                   FontSize="24"
                   FontWeight="Bold"
                   Visibility="{x:Bind ViewModel.IsEditMode, Converter={StaticResource InverseVisibilityConverter}}"/>
        
        <!-- Product Price -->
        <TextBlock Text="Price" Style="{StaticResource LabelStyle}" Margin="0,10,0,0"/>
        <TextBox x:Name="PriceTextBox"
                 Text="{x:Bind ViewModel.Price, Mode=OneWay}"
                 IsReadOnly="{x:Bind ViewModel.IsEditMode, Converter={StaticResource InverseBooleanConverter}}"
                 TextChanging="PriceTextBox_TextChanging"
                 InputScope="Number"
                 Style="{StaticResource StandardTextBoxStyle}"
                 Visibility="{x:Bind ViewModel.IsEditMode, Mode=OneWay}"/>
        <TextBlock Text="{x:Bind ViewModel.Price, Converter={StaticResource PriceFormatConverter}, Mode=OneWay}"
                   FontSize="20"
                   Foreground="#0078D4"
                   FontWeight="SemiBold"
                   Visibility="{x:Bind ViewModel.IsEditMode, Converter={StaticResource InverseVisibilityConverter}}"/>
        
        <!-- Product Description -->
        <TextBlock Text="Description" Style="{StaticResource LabelStyle}" Margin="0,10,0,0"/>
        <TextBox Text="{x:Bind ViewModel.Description, Mode=TwoWay}"
                 IsReadOnly="{x:Bind ViewModel.IsEditMode, Converter={StaticResource InverseBooleanConverter}}"
                 Style="{StaticResource StandardTextBoxStyle}"
                 MinHeight="100"
                 TextWrapping="Wrap"
                 AcceptsReturn="True"
                 Visibility="{x:Bind ViewModel.IsEditMode, Mode=OneWay}"/>
        <TextBlock Text="{x:Bind ViewModel.Description, Mode=OneWay}"
                   FontSize="16"
                   TextWrapping="Wrap"
                   Margin="0,5,0,0"
                   Visibility="{x:Bind ViewModel.IsEditMode, Converter={StaticResource InverseVisibilityConverter}}"/>
        
        <!-- Product Image -->
        <TextBlock Text="Image (Emoji)" Style="{StaticResource LabelStyle}" Margin="0,10,0,0"/>
        <TextBox Text="{x:Bind ViewModel.Image, Mode=TwoWay}"
                 IsReadOnly="{x:Bind ViewModel.IsEditMode, Converter={StaticResource InverseBooleanConverter}}"
                 Style="{StaticResource StandardTextBoxStyle}"
                 Visibility="{x:Bind ViewModel.IsEditMode, Mode=OneWay}"/>
        <TextBlock Text="{x:Bind ViewModel.Image, Mode=OneWay}"
                   FontSize="48"
                   HorizontalAlignment="Center"
                   Visibility="{x:Bind ViewModel.IsEditMode, Converter={StaticResource InverseVisibilityConverter}}"/>
        
        <!-- Error Message -->
        <TextBlock Text="{x:Bind ViewModel.ErrorMessage, Mode=OneWay}"
                   Style="{StaticResource ErrorTextStyle}"
                   Visibility="{x:Bind ViewModel.ErrorMessage, Converter={StaticResource StringToVisibilityConverter}}"
                   Margin="0,10,0,0"/>
        
        <!-- Action Buttons -->
        <StackPanel Orientation="Horizontal" 
                    Spacing="10"
                    HorizontalAlignment="Stretch"
                    Margin="0,30,0,0">
          <Button Content="Save" 
                  Command="{x:Bind ViewModel.SaveProductCommand}"
                  Visibility="{x:Bind ViewModel.IsEditMode, Mode=OneWay}"
                  Style="{StaticResource PrimaryButtonStyle}"/>
          <Button Content="Delete" 
                  Command="{x:Bind ViewModel.DeleteProductCommand}"
                  Style="{StaticResource DangerButtonStyle}"/>
          <Button Content="Back" 
                  Command="{x:Bind ViewModel.GoBackCommand}"
                  Style="{StaticResource SecondaryButtonStyle}"/>
        </StackPanel>
        
      </StackPanel>
    </ScrollViewer>
    
    <!-- Loading Indicator Overlay -->
    <controls:LoadingIndicator IsLoading="{x:Bind ViewModel.IsLoading, Mode=OneWay}"
                               Message="Saving..."/>
  </Grid>
</Page>

